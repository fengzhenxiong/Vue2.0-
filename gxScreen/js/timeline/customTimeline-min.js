"use strict";$.fn.timeline=function(e,t){function n(){this.initTag=!0}var a={start:2,startType:"news",replayDelay:2e3,autoplay:!0,loop:!0,interval:1e4,animateTime:500,navAnimateTime:1e3,addToFirst:!0,start_at_end:!1,range:[.5,1],default_range:.5,on_the_hour:!0,on_half_hour:!1,on_cur_hour:!0,width:null,height:null,debug:!0,maxLen:100,degreeBase:"hot",showPos:"right",ext_html:"",info:!0,absoluteEqual:!1,degreeText:!1,degree:[{cls:"tlLevelOne",range:[20]},{cls:"tlLevelTwo",range:[20,30]},{cls:"tlLevelThree",range:[30,40]},{cls:"tlLevelFour",range:[40]}]},i={data_err:"请传入正确的数据格式或者正确的请求地址。",request_err:"请求出错，请确认一下接口是否通过。",request_data_err:"接口返回数据不符合要求。",access_data_err:"传入的数据格式不符合要求。",data_null:"后台返回的数据的长度为空。"},l=this,s=$(l),r=null;!a.width&&(a.width=s.outerWidth()),!a.height&&(a.height=s.outerHeight()),e=$.extend({},a,e),n.prototype.warn=function(e){0==s.children(".timeline_load").length&&s.append("<div class='timeline_load'><div class='fn-s-lIOut'><div class='fn-s-lIc'><span class='fn-s-lIcL fn-fl'></span><span class='fn-s-lIcLR fn-fr'></span></div><div class='fn-s-lIName'>FANEWS</div></div><div class='timeline_msg'></div></div>");var t=(r=s.children(".timeline_load").eq(0)).children(".timeline_msg");e?t.html("错误提示："+e):t.html("")},n.prototype.hideWarn=function(){r.fadeOut(600)},n.prototype.checkData=function(){var n=this;if(this.warn(),!t)return e.debug&&console.warn(i.data_err),void this.warn(i.data_err);"string"==typeof t?$.ajax({url:t,type:"get",success:function(t){"string"==typeof t&&(t=JSON.parse(t)),t.events&&t.events instanceof Array?n.initHandleData(t.events):(n.warn(i.request_data_err),e.debug&&console.warn(i.request_data_err))},error:function(){e.debug&&console.warn(i.request_err),n.warn(i.request_err)},complete:function(){}}):t.events&&t.events instanceof Array?n.initHandleData(t.events):(n.warn(i.access_data_err),e.debug&&console.warn(i.access_data_err))},n.prototype.initHandleData=function(t){var n=this;if(n.initData=t,this.hideWarn(),0==t.length)e.debug&&console.warn(i.data_null),n.initialize({tag:!1});else{var a=n.handleDataCommon(t);n.data=a,n.initialize({tag:!0,data:a})}},n.prototype.handleDataCommon=function(e){for(var t,n,a=this,i=[],l=[],s=null,r=e.length,o=0;o<r;o++)if(s=e[o],t=a.formatTime(s.start_date).parts,n=Date.parse(new Date(t.year,t.month,t.day,t.hour,t.minute)),l.indexOf(n)<0){l.push(n);var d={};d.timeStamp=n,d.data=[s],d.start_date=s.start_date,i.push(d)}else i[i.length-1].data.push(s);return i},n.prototype.add=function(e){var t=this,n=e.length;if(0==n)return!1;t.pausePlay(),t.trigger("beforeAdd");var a=t.handleDataCommon(e);t.initData=t.initData?t.initData.concat(e):e,t.data=t.data?t.data.concat(a):a,t.endDate=t.formatTime(e[n-1].start_date).parts,t.disabledBtn(),t.defaultDraw(3),t.trigger("afterAdd",e)},n.prototype.removeData=function(e){for(var t=this,n=t.initData,a=t.$content,i=t.$navPa.children(".tlnav"),l=null,s=n.length,r=null,o=null,d=0,c=0;c<s;c++)if(r=n[c],l=i.eq(0),parseInt(l.attr("id").replace("nav_id_",""))==e){o=r,d=c;break}var v=a.find(".timeline_inner_uls li").eq(d);return{data:o,index:d,handleIndexOne:v.parent().parent().parent().index(),handleIndexTwo:v.index()}},n.prototype.remove=function(e){var t=this,n=e.length,a="",i=null,l=null,s=null,r=0,o=0,d=0;t.pausePlay(),t.trigger("beforeRemove");for(var c=0;c<n;c++)a=e[c],r=(s=t.removeData(a)).index,o=s.handleIndexOne,d=s.handleIndexTwo,i=t.$contentPa.find("#content_id_"+a),l=t.$contentPa.find("#order_id_"+a),t.$navPa.find("#nav_id_"+a).remove(),t.initData.splice(r,1),t.data[o].data.splice(d,1),1===i.parent().children().length?(i.parent().parent().parent().remove(),t.data.splice(o,1),t.navNum--,r<t.curIndex&&t.curNavIndex--):(i.remove(),l.remove()),r==t.curIndex?t.goTo(r+1,"news"):r<t.curIndex&&t.curIndex--,t.totalNum--,t.restartPlay();t.$totalNum.text(t.totalNum),t.$navNum.text(t.navNum),t.trigger("afterRemove")},n.prototype.drawTime=function(t,n,a,i,l){for(var r=this,o="",d=0,c=r.data,v=0;v<n;v++){var u=30*v*t;o+="<div title='"+(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds())+"' style='left: "+u+"px;' class='tltime'><span>"+a.getHours()+"点"+(a.getMinutes()?a.getMinutes():"")+"</span></div>",a.setMinutes(a.getMinutes()+30)}r.$timePa.append(o);var m=r.$navPa.children(".tlnav").length>0?parseInt(r.$navPa.children(".tlnav").last().attr("id").replace("nav_id_",""))+1:1;if(r.data){for(var p=c.length,f=null,h=null,_="",g="",$=e.degreeBase,y=e.degreeText,w=e.absoluteEqual,x=e.degree,b=x.length,T=s.find(".timeline_total").eq(0),C=s.find(".timeline_times").eq(0),N=s.find("#timeline_page_num").eq(0),D=s.find("#timeline_nav_num").eq(0),P=r.totalNum?r.totalNum:0,I=r.navNum?r.navNum:0,q=I;q<p;q++){f=c[q],h=r.formatTime(f.start_date).parts,f.timeStamp,_+=0==q?'<li class="timeline_one_content cur"><div class="timeline_inner_navs">':'<li class="timeline_one_content"><div class="timeline_inner_navs">';var k=new Date(h.year,parseInt(h.month)-1,h.day,h.hour,h.minute),L=r.timeDistance(i,k,1).minute*t,z=f.data,B='<ul class="timeline_inner_uls">',H='<ol class="timeline_inner_orders">',M=z.length,S=null;d+=q*M;for(var F=0;F<M;F++){var A="",O="",W=M-F,R=(S=z[F]).id?"content_id_"+S.id:"content_id_"+m,E=S.id?"order_id_"+S.id:"order_id_"+m,V=S.id?"nav_id_"+S.id:"nav_id_"+m;m++,0==F&&(A="active"),P++;var Z=/\{(\w+)\}/g,j=e.ext_html;Z.test(j)&&(j=j.replace(Z,function(e,t){return S.custom[t]})),B+='<li id="'+R+'" class="'+A+'"><div class="timeline_def_content"><div class="timeline_media"><img src="'+S.media.url+'"></div><div class="timeline_text"><h3 class="timeline_text_head">'+S.text.headline+'</h3><div class="timeline_text_small">'+S.text.text+'</div></div></div><div class="timeline_ext_content">'+j+"</div></li>",H+="<li id='"+E+"' class='timeline_inner_order "+A+"'></li>";for(var K=S.nav[$],X="",Y=0;Y<b;Y++){var J=x[Y];if(O=J.text,w){if(K==J.range){X=J.cls;break}}else if(0==Y){if(K>=0&&K<J.range[0]){X=J.cls;break}}else if(Y==b-1){if(K>=J.range[0]){X=J.cls;break}}else if(K>=J.range[0]&&K<J.range[1]){X=J.cls;break}}g+='<div id="'+V+'" style="left: '+L+"px; z-index: "+W+'" class="tlnav '+X+'"><div class="tlcontent"><div class="tlConInner fl"><div class="tlCITop"><img src="'+S.nav.url+'"/><h3>'+S.nav.title+'</h3></div><div class="tlCIBot"><div class="tlKey fl"><span class="tlKeyVal">'+S.nav.tag.join(" ")+'</span></div><div class="tlTimeTag fr"><span class="tlBadge tlBadgeS">军事</span></div></div></div><div class="tlHotTop fr"><img src="../../images/icons/fire2.svg"/><span class="tlHotVal"><span class="tlHotValInner">'+(y?O:S.nav.hot)+'</span></span></div><span class="tl_warn">'+(F+1)+'</span></div><div class="tlline"></div><div class="tlCircle"><div class="tlHot"><span class="tlleft"><span class="tlInner tlLeftInner"></span></span><span class="tlright"><span class="tlInner tlRightInner"></span></span></div><div class="tlText">'+h.hour+":"+h.minute+"</div></div></div>"}I++,_+=(B+="</ul>")+(H+="</ul>")+"</div></li>"}if(T.text(P),C.text(I),r.$totalNum=T,r.$navNum=C,N.attr("max",P),D.attr("max",I),r.$navPa.append(g),r.$contentPa.append(_),r.enabledBtn(),l&&3==l){if(e.addToFirst){var G=r.$navPa.children().eq(r.totalNum);r.goTo(G.index()+1,"news")}}else{var Q=r.$navPa.children().eq(0),U=parseInt(Q.css("left"))-200;r.$navPa.css({left:-U}),r.$timePa.css({left:-U})}r.totalNum=P,r.navNum=I}else r.totalNum=0,r.navNum=0},n.prototype.reDrawTime=function(e,t,n,a){var i=this,l=i.$navPa.children(".tlnav"),s=i.initData,r=null;l.each(function(t,n){r=s[t];var l=$(n),o=i.formatTime(r.start_date).parts,d=new Date(o.year,parseInt(o.month)-1,o.day,o.hour,o.minute),c=i.timeDistance(a,d,1).minute*e;l.css("left",c)}),i.setTimelinePos()},n.prototype.defaultDraw=function(t){var n=this,a=s.outerWidth(),i=e.default_range,l=n.startDate,r=n.endDate,o=a/(60*i),d=s.find(".timeline_time").eq(0),c=s.find(".timeline_abstract").eq(0),v=s.find(".timeline_inner_content").eq(0);n.$timePa=d,n.$navPa=c,n.$contentPa=v;var u=new Date(l.year,l.month-1,l.day,parseInt(l.hour)-Math.ceil(i)),m=new Date(l.year,l.month-1,l.day,parseInt(l.hour)-Math.ceil(i)),p=new Date(r.year,r.month-1,r.day,parseInt(r.hour)+1+Math.ceil(i)),f=n.timeDistance(u,p,30).minute,h=30*f*o;switch(d.width(h),c.width(h),t){case 1:n.drawTime(o,f,m,u);break;case 2:n.reDrawTime(o,f,m,u);break;case 3:n.drawTime(o,f,m,u,t)}},n.prototype.setTimelinePos=function(t){var n=this,a=n.$curNews;n.pausePlay();var i=0,l=a.css("left").replace("px","");if(l.indexOf("e+")>=0){var s=l.split("e+");i=parseFloat(s[0])*Math.pow(10,parseInt(s[1]))}else i=parseInt(l);var r=e.showPos,o=$(window).width(),d=n.calculateSize(a.get(0)),c=n.getDomPos(a.get(0)),v=d.left2-d.left,u=d.top2-d.top,m=0;switch(r){case"left":m=c.left>d.left?d.left-c.left:0;break;case"center":m=(o-(d.left2-d.left))/2;break;case"right":default:m=o-(d.left2-d.left+30)}var p=-(i-(c.left-d.left)-m);n.$hightlight.animate({top:d.top,left:m,width:v,height:u},e.animateTime),n.$navPa.animate({left:p+"px"},e.animateTime,t),n.$timePa.animate({left:p+"px"},e.animateTime,function(){})},n.prototype.disabledBtn=function(){var e=this;e.$start.addClass("disabled"),e.$pause.addClass("disabled"),e.$replay.addClass("disabled"),e.$goBtnPage.addClass("disabled"),e.$goBtnNav.addClass("disabled"),e.$prev.addClass("disabled"),e.$next.addClass("disabled")},n.prototype.enabledBtn=function(){var e=this;e.$start.removeClass("disabled"),e.$pause.removeClass("disabled"),e.$replay.removeClass("disabled"),e.$goBtnPage.removeClass("disabled"),e.$goBtnNav.removeClass("disabled"),e.$prev.removeClass("disabled"),e.$next.removeClass("disabled")},n.prototype.getDomPos=function(e){for(var t=0,n=0,a=0,i=0,l=e.offsetWidth,s=e.offsetHeight,r=e;r;)t+=r.offsetTop,n+=r.offsetLeft,r=r.offsetParent;return a=n+l,i=t+s,{top:t,left:n,top2:i,left2:a}},n.prototype.calculateSize=function(e){function t(e){e.each(function(e,n){var l=$(n);if("static"!=l.css("position")){var s=a.getDomPos(n);s.left<i.left&&(i.left=s.left),s.top<i.top&&(i.top=s.top),s.left2>i.left2&&(i.left2=s.left2),s.top2>i.top2&&(i.top2=s.top2),l.children().length>0&&t(l.children())}})}var n=$(e),a=this,i=a.getDomPos(e),l=n.children();return l.length>0&&t(l),i},n.prototype.dragTimeline=function(e,t,n,a){var i=this,l=t||window.event,r=($(e),l.pageX),o=s.find(".timeline_time"),d=s.find(".timeline_abstract"),c=$(window).width()/2,v=d.width();if(i.pausePlay(),i.dragPause=!0,r!=n){var u=0;(u=a+(r-n))>c&&(u=c),-u>v+c&&(u=-(v+c)),o.css("left",u+"px"),d.css("left",u+"px");var m=i.calculateSize(i.$curNews.get(0));i.$hightlight.css("left",m.left)}},n.prototype.timeDistance=function(e,t,n){var a=Date.parse(e),i=Date.parse(t)-a;return{stamp:i,minute:i/(60*n*1e3)}},n.prototype.goToFirst=function(){this.goTo(1,"news")},n.prototype.goToLast=function(){this.goTo(this.navNum,"nav")},n.prototype.goTo=function(t,n){var a=this,i=a.$navPa.children(".tlnav"),l=a.$contentPa,s=l.children(".timeline_one_content"),r=null,o=null;a.pausePlay(),a.trigger("beforeLunbo");var d=0;d=t>0?t-1:"news"==n?a.totalNum+t:a.navNum+t;var c=a.data,v=a.navNum,u=0,m=0;if("news"==n){r=i.eq(d),o=l.find(".timeline_inner_uls li").eq(d).parent().parent().parent();for(var p=0;p<v;p++)if(u+=c[p].data.length,d<u){m=c[p].data.length-(u-d);break}}else{for(var f=0;f<v&&f!=d;f++)u+=c[f].data.length;r=0==u?i.eq(0):i.eq(u),o=l.find(".timeline_inner_uls li").eq(u).parent().parent().parent()}if(a.$an_hide_contentli=s.filter(".cur"),a.$an_show_content=o,r.is(":hidden")&&r.show(),a.$curContent=o,a.curNavIndex=o.index(),a.$curNews=r,a.curIndex=r.index(),a.setNavZIndex(r),a.setTimelinePos(),o.hasClass("cur")){if(o.find(".timeline_inner_uls li.active").index()!=u){var h=o.find(".timeline_inner_uls li.active").attr("id").replace("content_id_","");a.$an_hide_nav=a.$navPa.find("#nav_id_"+h),a.innerCarousel()}}else{var _=s.filter(".cur").index(),g=o.index(),y="-100%";(_>g&&0!=g||0==_&&g==a.navNum-1)&&(o.css("left","-100%"),y="100%"),a.$an_hide_contentli.animate({left:y},e.animateTime,function(){$(this).css("left","100%").removeClass("cur"),a.resetHidingCon(),a.resetNavs()}),a.showIndexData(o,m),o.animate({left:0},e.animateTime,function(){$(this).addClass("cur"),a.startLunbo(),a.trigger("afterLunbo")})}},n.prototype.showIndexData=function(e,t){var n=e.find(".timeline_inner_uls li"),a=e.find(".timeline_inner_orders li"),i=n.filter(".active");i.index()!=t&&(i.css("top","-100%").removeClass("active"),n.eq(t).addClass("active").css("top","0"),a.removeClass("active").eq(t).addClass("active"))},n.prototype.resetHidingCon=function(){var e=this.$an_hide_contentli,t=e.find(".timeline_inner_uls li"),n=t.filter(".active"),a=n.index();1!==t.length&&0!=a&&(n.removeClass("active").css("top","-100%"),t.eq(0).addClass("active").css("top",0),e.find(".timeline_inner_orders li").filter(".active").removeClass("active").end().eq(0).addClass("active"))},n.prototype.on=function(e,t){this["on"+e]=t},n.prototype.trigger=function(e,t){var n=this;n["on"+e]&&n["on"+e]instanceof Function&&n["on"+e](t)},n.prototype.setNavZIndex=function(e){for(var t=this.$navPa.children(".tlnav"),n=t.length,a=1,i=0;i<n;i++){var l=t.eq(i),s=parseInt(l.css("z-index"));a<s&&(a=s)}e.css("z-index",a+1)},n.prototype.setHighlightSize=function(){var t=this,n=t.$curNews,a=t.calculateSize(n.get(0));if(parseInt(t.$hightlight.outerWidth())==a.top2-a.top)return!1;t.$hightlight.animate({height:a.top2-a.top,top:a.top},e.animateTime/8)},n.prototype.resetNavs=function(){var e=this;e.$curNews.siblings(".moved").each(function(t,n){var a=$(n);e.resetNav(a),a.show()})},n.prototype.resetNav=function(e){e.css({"z-index":1,top:0,opacity:1,left:parseInt(e.css("left"))+100+"px"}).removeClass("moved")},n.prototype.nextNav=function(){var t=this;1==t.$curContent.next().length?t.goTo(t.curNavIndex+2,"nav"):e.loop&&t.goTo(1,"nav")},n.prototype.prevNav=function(){var t=this,n=t.$curContent;1==n.prev().length?(n.prev().css("left","-100%"),t.goTo(t.curNavIndex,"nav")):e.loop&&(n.eq(t.navNum-1).css("left","-100%"),t.goTo(t.navNum,"nav"))},n.prototype.nextData=function(){var e=this,t=e.$curNews.index();t+1==e.totalNum?e.goToFirst():e.goTo(t+2,"news")},n.prototype.prevData=function(){var e=this,t=e.$curNews.index();0==t?e.goTo(e.totalNum,"news"):e.goTo(t,"news")},n.prototype.innerCarousel=function(){var t=this,n=t.$curNews.index(),a=t.$curContent,i=a.find(".timeline_inner_uls").children("li"),l=a.find(".timeline_inner_orders").children("li"),s=t.$content.find(".timeline_inner_uls li").eq(n).index(),r=e.animateTime;t.$an_hide_contentCh=i.filter(".active"),t.$an_show_contentCh=i.eq(s),t.$an_hide_contentCh.animate({top:"-100%"},r,function(){$(this).removeClass("active")}),t.$an_show_contentCh.animate({top:"0"},r,function(){$(this).addClass("active"),l.removeClass("active").eq(s).addClass("active")}),t.navAnimate()},n.prototype.navAnimate=function(){var t=this,n=t.$an_hide_nav,a=e.animateTime;n.show().addClass("moved").css("z-index",1003).animate({top:"100px"},a/2,function(){$(this).animate({left:parseInt($(this).css("left"))-100+"px",opacity:.3},a/2,function(){$(this).hide(),t.resetNav(n),t.setHighlightSize(),t.setNavZIndex(t.$curNews),t.startLunbo(),t.trigger("afterLunbo")})})},n.prototype.startLunbo=function(){var t=this;e.autoplay&&(t.timer=setTimeout(function(){t.nextData()},e.interval))},n.prototype.pausePlay=function(){var e=this;e.rePlayTimer&&clearTimeout(e.rePlayTimer),e.timer&&clearTimeout(e.timer),e.$an_hide_contentli&&e.$an_hide_contentli.stop(!0,!0),e.$an_show_content&&e.$an_show_content.stop(!0,!0),e.$an_hide_contentCh&&e.$an_hide_contentCh.stop(!0,!0),e.$an_show_contentCh&&e.$an_show_contentCh.stop(!0,!0),e.$an_hide_nav&&e.$an_hide_nav.stop(!0,!0)},n.prototype.restartPlay=function(){var t=this;if(!e.autoplay)return!1;t.pausePlay(),t.rePlayTimer=setTimeout(function(){t.goTo(t.curIndex+2,"news")},e.replayDelay)},n.prototype.formatTime=function(e){var t=e.year,n=e.month,a=e.day,i=e.hour?e.hour:"0",l=e.minute?e.minute:"0";return{total:t+"-"+n+"-"+a+" "+i+":"+l+":0",parts:{year:t,month:n,day:a,hour:i,minute:l,second:"0"}}},n.prototype.initialize=function(t){var n=this;0===s.children(".timeline_content").length&&s.append("<div class='timeline_content'><ul class='timeline_inner_content'></ul></div>"),0===s.children(".timeline_highlight").length&&s.append('<div class="timeline_highlight"></div>'),0===s.children(".timeline").length&&s.append('<div class="timeline"><div class="timeline_page"><p>一共有<span class="timeline_total">...</span>条数据</p><p>一共<span class="timeline_times">...</span>个时间点有数据</p><div class="timeline_start timeline_control disabled">开始</div><div class="timeline_pause timeline_control disabled">暂停</div><div class="timeline_replay timeline_control disabled">结束</div><div class="timeline_second_control">跳到<input type="number" class="timeline_page_num" min="1" value="1">条<button class="timeline_page_btn disabled">确定</button></div><div class="timeline_third_control">跳到                <input type="number" id="timeline_nav_num" class="timeline_page_num" min="1" value="1">条面板<button id="timeline_nav_btn" class="timeline_page_btn disabled">确定</button></div></div><div class="timeline_nav"><div class="timeline_time"></div><div class="timeline_abstract"></div></div><div class="timeline_modal"></div></div>'),e.info&&0===s.children(".timeline_info").length&&s.append('<div class="timeline_info"><div class="timeline_close">×</div><div class="timeline_degreeout"><span class="timeline_degree_one timeline_degree"></span><label>一级</label></div><div class="timeline_degreeout"><span class="timeline_degree_two timeline_degree"></span><label>二级</label></div><div class="timeline_degreeout"><span class="timeline_degree_three timeline_degree"></span><label>三级</label></div><div class="timeline_degreeout"><span class="timeline_degree_four timeline_degree"></span><label>四级</label></div></div>'),n.$start=s.find(".timeline_start").eq(0),n.$replay=s.find(".timeline_replay").eq(0),n.$pause=s.find(".timeline_pause").eq(0),n.$goBtnPage=s.find("#timeline_page_btn").eq(0),n.$iptPage=s.find("#timeline_page_num").eq(0),n.$goBtnNav=s.find("#timeline_nav_btn").eq(0),n.$iptNav=s.find("#timeline_nav_num").eq(0),n.$content=s.find(".timeline_inner_content").eq(0),n.$prev=s.find(".timeline_prev").eq(0),n.$next=s.find(".timeline_next").eq(0),n.$hightlight=s.find(".timeline_highlight").eq(0);var a=new Date,i=a.getFullYear(),l=a.getMonth()+1,r=a.getDate();if(t.tag){var o=t.data,d=o[0].start_date,c=o[o.length-1].start_date;n.startDate=n.formatTime(d).parts,n.endDate=n.formatTime(c).parts}else n.startDate={year:i,fMonth:l,fDay:r,hour:"0",minute:"0",second:"0"},n.endDate={year:i,fMonth:l,fDay:r,hour:"23",minute:"59",second:"59"};n.defaultDraw(1)},n.prototype.btnClick=function(e,t){if(e.hasClass("disabled"))return!1;t&&t()},n.prototype.closeInfo=function(){var e=s.find(".timeline_info"),t=e.outerWidth();e.animate({left:-t+"px"},300,function(){e.remove()})},n.prototype.init=function(){var t=this,n=s.find("#timeline_page_num").eq(0),a=s.find("#timeline_nav_num").eq(0);t.checkData(),t.goTo(e.start,e.startType),s.delegate(".timeline_modal","mousedown",function(e){var n=(e||window.event).pageX,a=parseInt(s.find(".timeline_time").css("left"));$(this).bind("mousemove",function(e){t.dragTimeline(this,e,n,a)})}),$(document).bind("mouseup",function(){s.find(".timeline_modal").unbind("mousemove"),t.dragPause&&(t.restartPlay(),t.dragPause=!1)}),$(window).bind("resize",function(){t.defaultDraw(2)}),s.delegate(".timeline_start","click",function(){t.btnClick($(this),function(){t.goTo(1)})}),s.delegate(".timeline_end","click",function(){t.btnClick($(this),function(){t.goTo(t.navNum)})}),s.delegate("#timeline_page_btn","click",function(){t.btnClick($(this),function(){var e=parseInt(n.val());e<-t.totalNum||e>t.totalNum||0==e?alert("请输入合适的页码！"):t.goTo(e,"news")})}),s.delegate("#timeline_nav_btn","click",function(){t.btnClick($(this),function(){var e=parseInt(a.val());e<-t.navNum||e>t.navNum||0==e?alert("请输入合适的页码！"):t.goTo(e,"nav")})}),s.delegate(".timeline_close","click",function(){t.closeInfo()}),s.delegate(".timeline_start","click",function(){t.goToFirst()}),s.delegate(".timeline_pause","click",function(){t.pausePlay()}),s.delegate(".timeline_replay","click",function(){t.restartPlay()}),s.delegate(".timeline_prev","click",function(){t.btnClick($(this),function(){t.prevNav()})}),s.delegate(".timeline_next","click",function(){t.btnClick($(this),function(){t.nextNav("nav")})}),s.delegate(".timeline_inner_order","mouseover",function(){var e=$(this),n=e.index();if(t.pausePlay(),e.hasClass("active"))return!1;for(var a=e.parent().parent().parent().index(),i=t.data,l=0,s=0;s<a;s++)l+=i[s].data.length;t.goTo(l+n+1,"news")}),s.delegate(".timeline_inner_order","mouseleave",function(){t.restartPlay()}),s.delegate(".tlnav","click",function(){var e=$(this).index()+1;t.pausePlay(),t.goTo(e,"news")})};var o=new n;return o.init(),o};